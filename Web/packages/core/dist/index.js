import{pushScopeId as t,popScopeId as n,openBlock as e,createBlock as a,withDirectives as o,createVNode as i,vShow as s,toDisplayString as r,withScopeId as c,resolveComponent as d,KeepAlive as l,resolveDynamicComponent as p,toRaw as u,Fragment as m,renderList as f,reactive as h,resolveDirective as g,shallowRef as v,unref as A,createApp as N}from"vue";import{dragable as x}from"@dokit/web-utils";var b={props:{title:{default:"DoKit"},canBack:{default:!0}},data:()=>({icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAzCAMAAADIDVqJAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAXFQTFRFAAAANX7GNHzFM3zFM3zFNn3ENYDHNHzFM3zENIDHNH7INH3ENX3GNn7GM33ENYDFNYDGM4DINH7HM3zENH3HNHzENYDGM37FM33FNH3FNn3FNX7HN4DINHzEM33HNH7FNIDGNn7GM33ENX3FNXzHNoDENH7FNH3EM3zEN33INHzFNH3FM4DHNX3HNH3GNX7ENHzENHzFNYDFNH3FM33ENn3JM33GN4DINX7EM3zEM33GNH7FM33FM33FNIDFNH3GNX3KM37HNHzFN4DINX7FNH3EOHzHNH3GM3zFM4DGM33EM3zENHzENH3EM33FOoTFgID/NHzFOIDHM3zEM3zFNoPJM33FM33ENH3FNHzENYDL////NHzENH3FM4PFM3zFOYDGNH3FM3zFN3zINHzEM33FNoDJM3zFM33FNH3ENHzFM37FNH3ENH3FM33ENH7GNX7FM33ENH3FNH7FM37ENH7FM3zFNH3EM4jMM3zE////TdHL6gAAAHl0Uk5TAEPy+vA9RPb0QEX3P0fzPkg8Sfg7SjpL+fE5TThON082Ue81UjRT++4zVO0yVjFX/OwwWOsvWi5b6i1d/eksXitf6Cph5yli/ihk5ieh3x8CoiCg4CGf4Z3iIgGc4yOaJJnkJZjlJpaVk5KQj42LioiHhYSCgHOyD3AmCqsAAAABYktHRFt0vJU0AAAACXBIWXMAAABIAAAASABGyWs+AAABPUlEQVQ4y43UxVoCUBQE4Ctgd3cXKAYoKqioINiBrdjdXby9C+6c3ZzPWf+rE2MMS4bDmY4rk5qs7FQ6ObnU5OXDFFBTCFNUTE2JmFJqysqtcVRQUymmiprqGmtq66ipF9NATSOMq4maZidMCzWtMG3t1HSI6aSmq9sat4eaHpheLzV9YvqpGRi0xuenZghmOEDNiJhRasZggiFqxiesmQxTMyVmmpoZmEiUmlmYWJyauXmYBWoWYZaWqTEr1qRW1zhaT4jaUNQm1Na2onagdjW1B7V/wFXyEOroWFEnok4VdQZ1fqGoS6ira0XdpP4x+uStKL5EY+6gYpq6h4rEFfUgKqqoRyjlkI15ggqGFfUsKqSoFyjlTY15hfIFFPUmyq+odyilhIz5gHJ7FfUpyqOoLyilYo35/rFJ/Jo/DZ3bT7fEcIgAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjEtMDQtMjFUMTc6MzI6MjgrMDg6MDBBnT5hAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIxLTA0LTIxVDE3OjMyOjI4KzA4OjAwMMCG3QAAAABJRU5ErkJggg=="}),methods:{handleBackRoute(){this.$emit("back")||this.$router.back()}}};const k=c("data-v-12d2fe44");t("data-v-12d2fe44");const H={class:"bar"},F=i("span",{class:"bar-back-btn"},"返回",-1),E={class:"bar-title"},M={class:"bar-title-text"};n();const z=k(((t,n,c,d,l,p)=>(e(),a("div",H,[o(i("div",{class:"bar-back",onClick:n[1]||(n[1]=(...t)=>p.handleBackRoute&&p.handleBackRoute(...t))},[i("img",{class:"bar-back-icon",src:l.icon},null,8,["src"]),F],512),[[s,c.canBack]]),i("div",E,[i("span",M,r(c.title),1)])]))));function C(t,n){void 0===n&&(n={});var e=n.insertAt;if(t&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===e&&a.firstChild?a.insertBefore(o,a.firstChild):a.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}C(".bar[data-v-12d2fe44] {\n  background-color: white;\n  height: 50px;\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0 10px;\n  box-sizing: border-box;\n  position: relative;\n  border-radius: 10px 10px 0 0;\n}\n.bar-back[data-v-12d2fe44] {\n  position: absolute;\n  left: 10px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n.bar-back-icon[data-v-12d2fe44] {\n  display: inline-block;\n  height: 18px;\n}\n.bar-back-btn[data-v-12d2fe44] {\n  color: #337CC4;\n  font-size: 16px;\n  margin-left: 5px;\n}\n.bar-title-text[data-v-12d2fe44] {\n  color: #333333;\n  font-size: 20px;\n}\n.bar-other-text[data-v-12d2fe44] {\n  color: #666666;\n  font-size: 16px;\n}\n"),b.render=z,b.__scopeId="data-v-12d2fe44";var I={components:{TopBar:b},data:()=>({}),computed:{component(){return this.$route.component},title(){return this.$route.title||"Dokit"},canBack(){return"home"!==this.$route.name}},created(){console.log(this.$router)}};const y=c("data-v-60e326b6");t("data-v-60e326b6");const D={class:"container"},w={class:"router-container"};n();const B=y(((t,n,o,s,r,c)=>{const u=d("top-bar");return e(),a("div",D,[i(u,{title:c.title,canBack:c.canBack},null,8,["title","canBack"]),i("div",w,[(e(),a(l,null,[(e(),a(p(c.component)))],1024))])])}));C(".container[data-v-60e326b6] {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 100px;\n  bottom: 0;\n  background-color: #f5f6f7;\n  display: flex;\n  flex-direction: column;\n  z-index: 999;\n  border-radius: 10px 10px 0 0;\n}\n.router-container[data-v-60e326b6] {\n  margin-top: 5px;\n  background-color: white;\n  flex: 1;\n  overflow-y: scroll;\n}\n"),I.render=B,I.__scopeId="data-v-60e326b6";var G={components:{},data:()=>({}),computed:{independPlugins(){return this.$store.state.independPlugins}},created(){console.log(this.$router)},methods:{toRaw:u}};const P=c("data-v-17e44a68");t("data-v-17e44a68");const R={class:"container",style:{"z-index":"998"}};n();const U=P(((t,n,o,i,s,r)=>(e(),a("div",R,[(e(!0),a(m,null,f(r.independPlugins,(t=>(e(),a(p(r.toRaw(t.component)),{key:t.name})))),128))]))));C(".container[data-v-17e44a68] {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n}\n"),G.render=U,G.__scopeId="data-v-17e44a68";const O=new class{constructor(t){let{state:n}=t;this.initData(n)}initData(t={}){this._state=h({data:t})}get state(){return this._state.data}install(t){t.provide("store",this),t.config.globalProperties.$store=this}}({state:{showContainer:!1,independPlugins:[],features:[]}});function T(t,n){O.state[t]=n}function X(){return O.state}function Y(t){O.state.showContainer=t||!O.state.showContainer}function q(t){O.state.independPlugins.findIndex((n=>n.name===t.name))>-1||O.state.independPlugins.push(t)}function _(t){let n=O.state.independPlugins.findIndex((n=>n.name===t));-1!==n&&O.state.independPlugins.splice(n,1)}var J={components:{RouterContainer:I,IndependContainer:G},directives:{dragable:x},data:()=>({btnConfig:{name:"dokit_entry",opacity:.5,left:window.innerWidth-50,top:window.innerHeight-100,safeBottom:50}}),computed:{state(){return this.$store.state},showContainer(){return this.state.showContainer},independPlugins(){return this.$store.state.independPlugins}},methods:{toggleShowContainer(){Y()}},created(){console.log("CurState: ",this.$store.state)}};const S=c("data-v-6f4c1c67");t("data-v-6f4c1c67");const j={class:"dokit-app"};n();const $=S(((t,n,r,c,l,p)=>{const u=d("router-container"),m=d("independ-container"),f=g("dragable");return e(),a("div",j,[o(i("div",{class:"dokit-entry-btn",style:{"z-index":"10000"},onClick:n[1]||(n[1]=(...t)=>p.toggleShowContainer&&p.toggleShowContainer(...t))},null,512),[[f,l.btnConfig]]),o(i("div",{class:"mask",onClick:n[2]||(n[2]=(...n)=>t.toggleContainer&&t.toggleContainer(...n))},null,512),[[s,p.showContainer]]),o(i(u,null,null,512),[[s,p.showContainer]]),o(i(m,null,null,512),[[s,p.independPlugins.length]])])}));C(".dokit-app[data-v-6f4c1c67] {\n  font-family: Helvetica Neue, Helvetica, Arial, sans-serif;\n}\n.dokit-entry-btn[data-v-6f4c1c67] {\n  width: 50px;\n  height: 50px;\n  padding: 10px;\n  box-sizing: border-box;\n  background-image: url(//pt-starimg.didistatic.com/static/starimg/img/OzaetKDzHr1618905183992.png);\n  background-size: 50px;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n.mask[data-v-6f4c1c67] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 3;\n  background-color: #333333;\n  opacity: 0.3;\n}\n"),J.render=$,J.__scopeId="data-v-6f4c1c67";const L="load",Q="unload",V=function(t,n){t.forEach((t=>{let{list:e}=t;e.forEach((t=>{Z(t[n])&&t[n]()}))}))},Z=function(t){return"function"==typeof t};var W={props:{title:{default:"专区"},list:{default:[]}},data:()=>({defaultIcon:"https://pt-starimg.didistatic.com/static/starimg/img/FHqpI3InaS1618997548865.png"}),methods:{handleClickItem(t){this.$emit("handleClickItem",t)}}};const K=c("data-v-227eea1f");t("data-v-227eea1f");const tt={class:"card"},nt={class:"card-title"},et={class:"card-title-text"},at={class:"item-list"},ot={class:"item-icon"},it={class:"item-title"};n();const st=K(((t,n,o,s,c,d)=>(e(),a("div",tt,[i("div",nt,[i("span",et,r(o.title),1)]),i("div",at,[(e(!0),a(m,null,f(o.list,((t,n)=>(e(),a("div",{class:"item",key:n,onClick:n=>d.handleClickItem(t)},[i("div",ot,[i("img",{class:"item-icon-image",src:t.icon||c.defaultIcon},null,8,["src"])]),i("div",it,r(t.nameZh||"默认功能"),1)],8,["onClick"])))),128))])]))));C(".card[data-v-227eea1f] {\n  margin-bottom: 10px;\n  padding: 10px;\n  background-color: white;\n}\n.card-title-text[data-v-227eea1f] {\n  font-size: 16px;\n  color: #333333;\n}\n.item-list[data-v-227eea1f] {\n  display: flex;\n  flex-wrap: wrap;\n  margin-top: 5px;\n}\n.item[data-v-227eea1f] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 25%;\n  margin-top: 5px;\n}\n.item .item-icon-image[data-v-227eea1f] {\n  width: 30px;\n}\n.item .item-title[data-v-227eea1f] {\n  font-size: 14px;\n  margin-top: 5px;\n}\n"),W.render=st,W.__scopeId="data-v-227eea1f";var rt={props:{version:String},data:()=>({dokitIcon:"https://pt-starimg.didistatic.com/static/starimg/img/eM7MJKDqVG1618998466986.png"})};const ct=c("data-v-3aae3480");t("data-v-3aae3480");const dt={class:"card version"},lt={class:"version-text"},pt={class:"version-image"};n();const ut=ct(((t,n,o,s,c,d)=>(e(),a("div",dt,[i("div",null,[i("span",lt,"当前版本：V"+r(o.version),1)]),i("div",pt,[i("img",{class:"dokit-icon",src:c.dokitIcon},null,8,["src"])])]))));C(".card[data-v-3aae3480] {\n  padding: 10px;\n  background-color: white;\n}\n.version[data-v-3aae3480] {\n  padding: 20px 0;\n  text-align: center;\n}\n.version .version-text[data-v-3aae3480] {\n  font-size: 16px;\n  color: #999999;\n}\n.version .version-image[data-v-3aae3480] {\n  margin-top: 20px;\n}\n.version .dokit-icon[data-v-3aae3480] {\n  width: 150px;\n}\n"),rt.render=ut,rt.__scopeId="data-v-3aae3480";var mt={components:{TopBar:b,Card:W,VersionCard:rt},data:()=>({version:"1.0.0"}),mounted(){},computed:{features(){return this.$store.state.features}},methods:{handleClickItem(t){switch(t.type){case"RouterPlugin":this.$router.push({name:t.name});break;case"IndependPlugin":q(t),this.$store.state.showContainer=!1}}}};const ft=c("data-v-c51fce46");t("data-v-c51fce46");const ht={class:"index-container"};n();const gt=ft(((t,n,o,s,r,c)=>{const l=d("card"),p=d("version-card");return e(),a("div",ht,[(e(!0),a(m,null,f(c.features,((t,n)=>(e(),a(l,{key:n,title:t.title,list:t.list,onHandleClickItem:c.handleClickItem},null,8,["title","list","onHandleClickItem"])))),128)),i(p,{version:r.version},null,8,["version"])])}));C(".index-container[data-v-c51fce46] {\n  background-color: #f5f6f7;\n}\n"),mt.render=gt,mt.__scopeId="data-v-c51fce46";const vt=[{name:"home",component:mt}];function At(t){let n=[];return t.forEach((t=>{let{list:e,title:a}=t;e.forEach((t=>{let{name:e,nameZh:o,component:i}=t;n.push({name:e,component:i,meta:{title:o,zone:a}})}))})),[...vt,...n]}function Nt(t){return function({routes:t}){const n=t,e=[],a=i("home"),o=v(a);function i(t){return n.find((n=>n.name===t))}function s({name:t}){let n=i(t)||a;o.value=n}return{currentRoute:o,addRoute:function(t){n.push(t)},removeRoute:function(t){let e=n.findIndex((n=>n.name===t));return-1!=e?n.splice(e,1):null},hasRoute:function(t){return-1!==n.findIndex((n=>n.name===t))},getRoutes:function(){return n},push:function({name:t}){e.push(t),s({name:t})},replace:function(t){e.pop(),e.push(t),s({name:t})},back:function(){let t=e[e.length-2];s({name:e[t]})},install:function(t){t.config.globalProperties.$router=this,Object.defineProperty(t.config.globalProperties,"$route",{get:()=>A(o)})}}}({routes:[...At(t)]})}const xt=()=>{};class bt{type="";name="";nameZh="";icon="";component=null;_onLoad=xt;_onUnload=xt;constructor(t){let{name:n,nameZh:e,icon:a,component:o,onLoad:i,onUnload:s}=t;this.name=n,this.nameZh=e,this.icon=a,this.component=o,this._onLoad=i||xt,this._onUnload=s||xt}load(){this._onLoad.call(this)}unload(){this._onUnload.call(this)}}class kt extends bt{type="RouterPlugin";constructor(t){super(t)}}class Ht extends bt{type="IndependPlugin";constructor(t){super(t)}}const Ft=function(t){return t instanceof kt},Et=function(t){return t instanceof Ht};class Mt{options=null;constructor(t){this.options=t;let n=N(J),{features:e}=t;n.use(Nt(e)),n.use(O),O.state.features=e,this.app=n,this.init(),this.onLoad()}onLoad(){V(this.options.features,L)}onUnload(){V(this.options.features,Q)}init(){let t=document.createElement("div");t.id="dokit-root",document.documentElement.appendChild(t);let n=document.createElement("div");n.id="dokit-container",this.app.mount(n),t.appendChild(n)}}var zt={Dokit:Mt};export default zt;export{bt as BasePlugin,Mt as Dokit,Ht as IndependPlugin,kt as RouterPlugin,q as addIndependPlugin,X as getGlobalData,Et as isIndependPlugin,Ft as isRouterPlugin,xt as noop,_ as removeIndependPlugin,Y as toggleContainer,T as updateGlobalData};
